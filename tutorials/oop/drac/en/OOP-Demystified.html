<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5.dev">
<meta name="description" content="">
<meta name="author" content="Dräc">
<title>PureBasic and Object-Oriented Programming — or «the OOP demystified»</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>PureBasic and Object-Oriented Programming</h1>
<div class="details">
<span id="author" class="author">Dräc</span><br>
<span id="revnumber">draft 0.1,</span>
<span id="revdate">November 9, 2016</span>
<br><span id="revremark">Reprint WIP: polishing English.</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#why-oop-in-purebasic">1. Why OOP in PureBasic?</a></li>
<li><a href="#object-concepts">2. Object Concepts</a>
<ul class="sectlevel2">
<li><a href="#the-notion-of-object">2.1. The Notion of Object</a></li>
<li><a href="#the-notion-of-class">2.2. The Notion of Class</a></li>
<li><a href="#the-notion-of-instance">2.3. The Notion of Instance</a></li>
<li><a href="#encapsulation">2.4. Encapsulation</a></li>
<li><a href="#inheritance">2.5. Inheritance</a></li>
<li><a href="#overloading">2.6. Overloading</a></li>
<li><a href="#the-notion-of-abstract-class">2.7. The Notion of Abstract Class</a></li>
</ul>
</li>
<li><a href="#concepts-implementation">3. Concepts Implementation</a></li>
<li><a href="#first-implementation">4. First Implementation</a>
<ul class="sectlevel2">
<li><a href="#concrete-class-and-abstract-class">4.1. Concrete Class and Abstract Class</a></li>
<li><a href="#instanciation">4.2. Instanciation</a></li>
<li><a href="#encapsulation-2">4.3. Encapsulation</a></li>
<li><a href="#inheritance-2">4.4. Inheritance</a></li>
<li><a href="#overloading-2">4.5. Overloading</a></li>
<li><a href="#conclusion">4.6. Conclusion:</a></li>
</ul>
</li>
<li><a href="#interface-instruction">5. Interface instruction</a>
<ul class="sectlevel3">
<li><a href="#initialization">5.1. Initialization:</a></li>
</ul>
</li>
<li><a href="#second-implementation">6. Second Implementation</a>
<ul class="sectlevel2">
<li><a href="#notion-of-object-interface">6.1. Notion of Object interface:</a></li>
<li><a href="#object-instanciation-and-object-constructor">6.2. Object Instanciation and Object Constructor</a></li>
<li><a href="#object-initialization">6.3. Object Initialization</a></li>
<li><a href="#object-destructor">6.4. Object Destructor</a></li>
<li><a href="#memory-allocations">6.5. Memory Allocations</a></li>
<li><a href="#encapsulation-3">6.6. Encapsulation</a></li>
<li><a href="#inheritance-3">6.7. Inheritance</a></li>
<li><a href="#get-and-set-object-methods">6.8. Get() and Set() object methods</a></li>
</ul>
</li>
<li><a href="#synthesis-and-notation">7. Synthesis and notation</a>
<ul class="sectlevel2">
<li><a href="#first-code-example">7.1. First Code-Example</a></li>
</ul>
</li>
<li><a href="#pb-class">8. PB Class</a>
<ul class="sectlevel2">
<li><a href="#purebasic-class">8.1. PureBasic Class</a></li>
<li><a href="#second-code-example">8.2. Second Code-Example</a></li>
<li><a href="#class-endclass">8.3. Class : EndClass</a></li>
<li><a href="#method-endmethod">8.4. Method : EndMethod</a></li>
<li><a href="#object-constructor">8.5. Object Constructor</a></li>
<li><a href="#object-destructor-2">8.6. Object destructor</a></li>
<li><a href="#inheritance-4">8.7. Inheritance</a></li>
<li><a href="#discussion">8.8. Discussion</a></li>
<li><a href="#reminder-of-types">8.9. Reminder of types</a></li>
</ul>
</li>
<li><a href="#conclusion-2">9. Conclusion</a></li>
<li><a href="#optimisations">Appendix A: Optimisations</a>
<ul class="sectlevel2">
<li><a href="#optimisation-get-and-set-methods">A.1. Optimisation: Get() and Set() methods</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="sidebarblock">
<div class="content">
<div class="title">About This Tutorial</div>
<div class="paragraph">
<p>This is a reprint of «Dräc»’s multi-paart tutorial <em>PureBasic and the Object-Oriented Programming</em>, also knwon as <em>the OOP demystified</em>, published in 2005  on <a href="http://drac.site.chez-alice.fr/Tutorials%20Programming%20PureBasic/POO/POO_Pourquoi_en.htm">drac.site.chez-alice.fr</a>.</p>
</div>
<div class="paragraph">
<p>It was reprinted with explicit permission of the author, who released the tutorial text and source codes under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution</a>  (CC BY 4.0) in response to the permission request to reproduce it inside the <a href="https://github.com/tajmone/purebasic-archives">PureBASIC Archives</a>.</p>
</div>
<div class="paragraph">
<p>The tutorial was ported from HTML to AsciiDoc by Tristano Ajmone, who also polsihed the English text — introducing slight adjustments in line with the tutorial aims (using the original <a href="http://drac.site.chez-alice.fr/Tutorials%20Programming%20PureBasic/POO/POO_Pourquoi.htm">French tutorial</a> as a reference) — and made minor changes to code examples (either aesthetic or to ensure compatibility with latest version of PureBASIC).</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="why-oop-in-purebasic"><a class="anchor" href="#why-oop-in-purebasic"></a>1. Why OOP in PureBasic?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Since many object-oriented languages already exist, trying to achive OOP in PureBasic — which is a procedural language — might come as a surprise.</p>
</div>
<div class="paragraph">
<p>The fact that some programming languages are defined «Object-Oriented», while others are not, is merely indicating the presence of specific keywords, which facilitate writing code according to the OOP paradigm.
That is to say: object-oriented languages introduce richer semantics; but compilation-wise they are not introducing any new aspects compared to a non-OO language, they’re just adding a layer over the latter.</p>
</div>
<div class="paragraph">
<p>Therefore, we can fully implement the OO paradigm in PureBasic, but we have to pay a price in terms of accuracy — both in development and in notation. And here we face the immediate advantages of (natively) object-oriented languages.</p>
</div>
<div class="paragraph">
<p>Nevertheless, besides the possibility of programming in PureBasic according to the OO paradigm, implementing object-oriented concepts in PureBasic offers us the interesting chance to reveal some of the underlying mechanisms of OO languages keywords.</p>
</div>
<div class="paragraph">
<p>This paper presents a programming technique that allows large projects to benefit from object oriented design. It is not intended as a course on OOP, and it assumes that the reader has good knowledge of PureBasic language.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="object-concepts"><a class="anchor" href="#object-concepts"></a>2. Object Concepts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Object-Oriented Programming paradigm introduces concepts like: objects,  inheritance and polymorphism.
Before jumping into how these concepts can be implemented in PureBasic, we must first define them.</p>
</div>
<div class="sect2">
<h3 id="the-notion-of-object"><a class="anchor" href="#the-notion-of-object"></a>2.1. The Notion of Object</h3>
<div class="paragraph">
<p>An object has an internal state:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The state is represented by the value of each inner component at a given moment,</p>
</li>
<li>
<p>A component is either a value or another object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It uses and gives services:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It interacts with the outside through functions called «methods».</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is unique (notion of identity)</p>
</div>
<div class="paragraph">
<p>An object can be seen at two levels:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>By the services which it returns: external view (specification). This is the User side,</p>
</li>
<li>
<p>By the way that services are implemented within it : internal view (implementation). This is the Developer side.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>From the developer’s point of view of, an object is a contiguous memory area containing information: variables called <strong>attributes</strong> and functions called <strong>methods</strong>.</p>
</div>
<div class="paragraph">
<p>The fact that we refer to an object’s functions as «its methods» is because they belong to it and allow manipulation of its attributes.</p>
</div>
</div>
<div class="sect2">
<h3 id="the-notion-of-class"><a class="anchor" href="#the-notion-of-class"></a>2.2. The Notion of Class</h3>
<div class="paragraph">
<p>This is an extension of the concept of <strong>Type</strong> found in PureBasic.</p>
</div>
<div class="paragraph">
<p>In a given context, multiple objects can have the same structure and behavior.
Then can therefore be grouped together in the same «Class».</p>
</div>
<div class="paragraph">
<p>From a developer’s point of view, a Class defines the type of contents that will be held by objects belonging to it: the nature of their attributes (type of each variable) and their methods (names, implementation).</p>
</div>
<div class="paragraph">
<p>Just as integer is the type of a variable, the type of an object is its Class.</p>
</div>
</div>
<div class="sect2">
<h3 id="the-notion-of-instance"><a class="anchor" href="#the-notion-of-instance"></a>2.3. The Notion of Instance</h3>
<div class="paragraph">
<p>An instance is an object defined from a Class.</p>
</div>
<div class="paragraph">
<p>This process is called instanciation.</p>
</div>
<div class="paragraph">
<p>It corresponds to the assignement of variables in PureBasic.</p>
</div>
<div class="paragraph">
<p>Normally, an object is <strong>initialized</strong> at the time of its instanciation.</p>
</div>
</div>
<div class="sect2">
<h3 id="encapsulation"><a class="anchor" href="#encapsulation"></a>2.4. Encapsulation</h3>
<div class="paragraph">
<p>In theory, the manipulation of objects’ attributes should be possible only through its methods. This technique, which allows making visible to the user only a part of the object, is called encapsulation.</p>
</div>
<div class="paragraph">
<p>The advantage of encapsulation is that it guarantees the integrity of attributes. Indeed, the developer is the only one who, through the methods provided to the user, manages the modifications allowed on an object.</p>
</div>
<div class="paragraph">
<p>At our level, this is the least that should be retained of the encapsulation concept.</p>
</div>
</div>
<div class="sect2">
<h3 id="inheritance"><a class="anchor" href="#inheritance"></a>2.5. Inheritance</h3>
<div class="paragraph">
<p>Inheritance allows defining new Classes by using already existing ones.</p>
</div>
<div class="paragraph">
<p>From the developer’s point of view, it means being able to add/modify attributes and methods to/of an existing Class in order to define a new Class.</p>
</div>
<div class="paragraph">
<p>There are two kinds of inheritances:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Simple inheritance</strong>: the new Class is defined from a single existing Class.</p>
</li>
<li>
<p><strong>Multiple inheritance</strong>: the new Class is defined from several existing Classes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Multiple inheritance is complex to implement, and it will not be covered here.
Thus, this papers deals only with simple inheritance.</p>
</div>
<div class="paragraph">
<p>Terminology:
The Class which inherits from another Class, is often called <strong>Child Class</strong>.
The Class which gives its inheritance to a Child Class is often called <strong>Parent Class</strong>.</p>
</div>
</div>
<div class="sect2">
<h3 id="overloading"><a class="anchor" href="#overloading"></a>2.6. Overloading</h3>
<div class="paragraph">
<p>A method is overloaded if it carries out different actions according to the nature of the target objects.</p>
</div>
<div class="paragraph">
<p>Let us take an example:</p>
</div>
<div class="paragraph">
<p>The following objects: circle, rectangle and triangle are all geometrical shapes.
We can define for these objects the same Class with the given name: <code>Shape</code>.
Thus, these objects are all instances of the <code>Shape</code> Class.</p>
</div>
<div class="paragraph">
<p>If we want to display the objects, the <code>Shape</code> Class needs to have a <code>Draw</code> method.</p>
</div>
<div class="paragraph">
<p>So endowed, every object has a <code>Draw</code> method to display itself. Now, this method could not possibly be the same for each object, as we want to display a circle, in one case, a rectangle, in onether, and so on.</p>
</div>
<div class="paragraph">
<p>The objects of the same Class use the same <code>Draw</code> method, but the object’s nature (Circle, Rectangle, or Triangle) dictates the implementation of the method.
The <code>Draw</code> method is overloaded: for the user, displaying a circle or a rectangle is achieved in the same way.
From the developer’s point of view, the methods implementations needs to be different.</p>
</div>
<div class="paragraph">
<p>Instead of overloaded methods, we can also speak of polymorphic methods (having several forms).</p>
</div>
</div>
<div class="sect2">
<h3 id="the-notion-of-abstract-class"><a class="anchor" href="#the-notion-of-abstract-class"></a>2.7. The Notion of Abstract Class</h3>
<div class="paragraph">
<p>As shown above, a Class includes the definition of both attributes and methods of an object.</p>
</div>
<div class="paragraph">
<p>Let us suppose that we can’t provide the implementation of one of the Class methods. The method is just a name without code. We then speak of abstract method.
A Class containing at least an abstract method qualifies as an abstract Class.</p>
</div>
<div class="paragraph">
<p>You might wonder why an abstract class should exist, since objects of such a Class can’t be created. Abstract Classes allow defining Object Classes, which are considered — by opposition — as being concrete. The transition from the former to the latter occurs through inheritance, where the concrete Class takes care of providing the missing implementations to the abstract methods inherited.</p>
</div>
<div class="paragraph">
<p>Thus, abstract Classes are a kind of interface, because they describe the generic specification of all the Classes which inherit from them.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="concepts-implementation"><a class="anchor" href="#concepts-implementation"></a>3. Concepts Implementation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section, I shall demonstrate how object concepts can be simply implemented in PureBasic.
This implementation doesn’t refer what is programmed in object-oriented languages. Furthermore, this implementation aims to be improved or adapted according to needs.</p>
</div>
<div class="paragraph">
<p>Thus, I propose here one of these implementations with its own advantages and limits.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="first-implementation"><a class="anchor" href="#first-implementation"></a>4. First Implementation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="concrete-class-and-abstract-class"><a class="anchor" href="#concrete-class-and-abstract-class"></a>4.1. Concrete Class and Abstract Class</h3>
<div class="paragraph">
<p>As seen, a Class defines the contents of an object:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Its attributes (each variable type)</p>
</li>
<li>
<p>Its methods (Names, implementation)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, if I want to represent Rectangle objects and to display them on the screen, I shall define a <code>Rectangle</code> Class including a <code>Draw()</code> method.</p>
</div>
<div class="paragraph">
<p>The <code>Rectangle</code> Class could have the following construction:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Structure Rectangle
  *Draw
  x1.l
  x2.l
  y1.l
  y2.l
EndStructure

Procedure Draw_Rectangle(*this.Rectangle)
  ; [ ...some code... ]
EndProcedure</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>x1</code>, <code>x2</code>, <code>y1</code> and <code>y2</code> are four attributes (diametrically opposite points coordinates of the rectangle) and <code>*Draw</code> is a pointer referencing to the drawing function which displays Rectangles.</p>
</div>
<div class="paragraph">
<p>Here <code>*Draw</code> is a function pointer used to contain the address of the desired function: <code>@Draw_Rectangle()</code>.
A function thus referenced can be invoked by using <code>CallFunctionFast()</code>.</p>
</div>
<div class="paragraph">
<p>Thus, the proposed <code>Structure</code> is completely adapted to the Class notion:
* the structure stores the definition of the object attributes: here <code>x1</code>, <code>x2</code>, <code>y1</code> and <code>y2</code> are Long variables.
* the structure stores the definition of the object method: here the <code>Draw()</code> function, through to a function pointer.</p>
</div>
<div class="paragraph">
<p>When a similar Class definition is followed by the implementations of its methods (in our example, <code>Draw_Rectangle()</code>’s <code>Procedure</code>/<code>EndProcedure</code> block statement), it becomes a concrete Class. Otherwise, it will be an abstract Class.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>*this</code> always refers to the object on which the method must be applied. This notation can be seen in the previous example, as <code>Draw_Rectangle()</code> method’s parameter.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="instanciation"><a class="anchor" href="#instanciation"></a>4.2. Instanciation</h3>
<div class="paragraph">
<p>Now, to create an object called <code>Rect1</code> from the <code>Rectangle</code> Class, write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Rect1.Rectangle</code></pre>
</div>
</div>
<div class="paragraph">
<p>To initialize it, simple write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Rect1\Draw = @Draw_Rectangle()
Rect1\x1 = 0
Rect1\x2 = 10
Rect1\y1 = 0
Rect1\y2 = 20</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, to draw Rect1 object, do:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">CallFunctionFast(Rect1\Draw, @Rect1)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="encapsulation-2"><a class="anchor" href="#encapsulation-2"></a>4.3. Encapsulation</h3>
<div class="paragraph">
<p>In this implementation, the encapsulation doesn’t exist, simply because there is no way to hide the attributes or the methods of such an object.</p>
</div>
<div class="paragraph">
<p>By writing <code>Rect1\x1</code>, the user can access to the attribute <code>x1</code> of the object. This is the way we used to initialize the object.
The next implementation (<a href="#second-implementation">Second Implementation</a> section) will show how to fix this.
Although significant, this feature is not essential in implementing OOP.</p>
</div>
</div>
<div class="sect2">
<h3 id="inheritance-2"><a class="anchor" href="#inheritance-2"></a>4.4. Inheritance</h3>
<div class="paragraph">
<p>Now I want to create a new Class with the capability to Erase rectangles from the screen.
I can implement this new <code>Rectangle2</code> Class by using the existing <code>Rectangle</code> Class and by providing it with a new method called <code>Erase()</code>.</p>
</div>
<div class="paragraph">
<p>A Class being a <code>Structure</code>, let’s take advantage of the extension property of structures. So, the new Class <code>Rectangle2</code> could be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Structure Rectangle2 Extends Rectangle
  *Erase
EndStructure

Procedure Erase_Rectangle(*this.Rectangle2)
  ; [ ...some code... ]
EndProcedure</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Rectangle2</code> Class includes as well members of the previous Rectangle Class and the new Erase() method.
To instanciate an object from this new Class write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Rect2.Rectangle2

Rect2\Draw = @Draw_Rectangle()
Rect2\Erase = @Erase_Rectangle()
Rect2\x1 = 0
Rect2\x2 = 10
Rect2\y1 = 0
Rect2\y2 = 20</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use <code>Rect2</code>’s <code>Draw()</code> and <code>Erase()</code> methods, I shall proceed the same way as before: through <code>CallFunctionFast()</code>.</p>
</div>
<div class="paragraph">
<p>That demonstrates that the <code>Rectangle2</code> Class inherited the properties of <code>Rectangle</code> Class.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Inheritance is a category of polymorphism. The object <code>Rect2</code> can be also seen as an Object from the <code>Rectangle</code> Class —  just don’t use the <code>Erase()</code> method! By inheritance, the object carries several forms: those of the objects coming from the Parent Classes. It is called inheritance polymorphism.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="overloading-2"><a class="anchor" href="#overloading-2"></a>4.5. Overloading</h3>
<div class="paragraph">
<p>During the initialization of an object, the function pointers are initialized by assigning to them the method addresses suiting the object.</p>
</div>
<div class="paragraph">
<p>So, given an object <code>Rect</code> from the <code>Rectangle</code> Class, by writing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Rect1\Draw = @Draw_Rectangle()</code></pre>
</div>
</div>
<div class="paragraph">
<p>I can use the <code>Draw()</code> method as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">CallFunctionFast(Rect1\Draw, @Rect1)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, imagine that it is possible to implement another method for displaying a rectangle (by using an algorithm different from the one in the first method).</p>
</div>
<div class="paragraph">
<p>Let us call this implementation as <code>Draw_Rectangle2()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Procedure Draw_Rectangle2(*this.Rectangle)
  ; [ ...some code... ]
EndProcedure</code></pre>
</div>
</div>
<div class="paragraph">
<p>It’s possible to initialize our object <code>Rect1</code> with this new method effortlessly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Rect1\Draw = @Draw_Rectangle2()</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use the method, write again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">CallFunctionFast(Rect1\Draw, @Rect1)</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can see that with both the former method (ie: <code>Draw_Rectangle()</code>) as well as the latter (ie: <code>Draw_Rectangle2()</code>) the use of the <code>Rect1</code> method is strictly identical.</p>
</div>
<div class="paragraph">
<p>It isn’t possible to distinguish by the single line of code <code>CallFunctionFast(Rect1\Draw, @Rect1)</code> which one of the <code>Draw()</code> methods the <code>Rect1</code> object is really using.
To know this, it is necessary to go back to the initialization of the object.</p>
</div>
<div class="paragraph">
<p>The notion of function pointer allows overloading the <code>Draw()</code> method.</p>
</div>
<div class="paragraph">
<p>One limitation: the use of the <code>CallFunctionFast()</code> instruction implies paying attention to the number of parameters passed.</p>
</div>
</div>
<div class="sect2">
<h3 id="conclusion"><a class="anchor" href="#conclusion"></a>4.6. Conclusion:</h3>
<div class="paragraph">
<p>In this first implementation, we produced an object capable of meeting the main object-oriented concepts, albeit with certain limitations.</p>
</div>
<div class="paragraph">
<p>We mainly just lay the foundations upon which we shall implement a more complete object — thanks to PureBasic’s <code>Interface</code> statement!</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="interface-instruction"><a class="anchor" href="#interface-instruction"></a>5. Interface instruction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic pseudocode" data-lang="purebasic pseudocode">Interface &lt;Name1&gt; [Extends &lt;Name2&gt;]
  [Procedure1]
  [Procedure2]
  ...
EndInterface</code></pre>
</div>
</div>
<div class="paragraph">
<p>The PureBasic Interface instruction allows grouping under the same Name (<code>&lt;Name1&gt;</code> in the above box) various procedures.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Interface My_Object
  Procedure1(x1.l, y1.l)
  Procedure2(x2.l, y2.l)
EndInterface</code></pre>
</div>
</div>
<div class="paragraph">
<p>By declaring an element of <code>My_Object</code>, the access to its procedures looks like as follows.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The statement is made in the same way as for a <code>Structure</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Object.My_Object</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>To use the object functions, write directly:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Object\Procedure1(10, 20)
Object\Procedure2(30, 40)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the Interface instruction leads to a very practical and pleasant notation to operate a procedure.
By writing <code>Object\Procedure1(10, 20)</code>, the <code>Procedure1()</code> from <code>Object</code> is called.
This notation is typical of the Object-oriented Programming.</p>
</div>
<div class="sect3">
<h4 id="initialization"><a class="anchor" href="#initialization"></a>5.1. Initialization:</h4>
<div class="paragraph">
<p>After a variable statement follows normally the variable initialization.
It’s the same for an element from an Interface.</p>
</div>
<div class="paragraph">
<p>As unexpected, by giving the name of a procedure inside the Interface:EndInterface block you don’t refere to the implementation of the procedure, e.i. to refer to the Procedure:EndProcedure block of the wished procedure.</p>
</div>
<div class="paragraph">
<p>In fact, you can rename procedures inside a Interface:EndInterface block, by giving the names you want for the procedures that you go to use.</p>
</div>
<div class="paragraph">
<p>Then, how to connect this new name with the wished procedure?</p>
</div>
<div class="paragraph">
<p>As for overloaded methods, the solution is in the function addresses.
It is necessary to see names, into the Interface:EndInterface block, as function pointers in which the required function addresses are attributed.</p>
</div>
<div class="paragraph">
<p>However, to initialize the function pointers of an Interface specified element, it is necessary to process differently than for a Structure specified element.
In fact, it isn’t possible to initialize individually each field defined by an Interface, because remember that Object\Procedure1() means a procedure call.</p>
</div>
<div class="paragraph">
<p>The initialization comes indirectly by giving to the element, the address of a initialized variable storing the function pointers.</p>
</div>
<div class="paragraph">
<p>A such variable is called: the table of the methods.</p>
</div>
<div class="paragraph">
<p>Ex: by resuming the Interface My_Object, let us consider the following Structure describing the function pointers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Structure My_Methods
  *Procedure1
  *Procedure2
EndStructure</code></pre>
</div>
</div>
<div class="paragraph">
<p>and the associated table of the methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Methods.My_Methods
Methods\Procedure1 = @My_Procedure1()
Methods\Procedure2 = @My_Procedure2()</code></pre>
</div>
</div>
<div class="paragraph">
<p>where My_Procedure1() and My_Procedure2() are the wished procedure implementations.</p>
</div>
<div class="paragraph">
<p>Then, the initialization of Object from Interface My_Object looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Object.My_Object = @Methods</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, by writing</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Object\Procedure2(30, 40)</code></pre>
</div>
</div>
<div class="paragraph">
<p>the Object <code>Procedure2()</code> function is called according <code>My_Procedure2()</code> implementation.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When an element from an Interface is declared, it is essential to initialize it before using element’s procedures. Thus it is advised to initialize the element at statement time.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The table of methods structure composition must be the exact representation of the Interface composition. It must contain the same number of fields and must preserve the order of them to insure the right assignation between names and addresses of each function. It is only on these conditions that the element will be correctly initialized.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To summarize, using an Interface involve:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an Interface describing the required procedures to use,</p>
</li>
<li>
<p>a Structure describing the function pointers,</p>
</li>
<li>
<p>a table of the methods: a structured variable initialized with the required function adresses.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and the properties are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an object-oriented notation</p>
</li>
<li>
<p>an easy way to rename procedures</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="second-implementation"><a class="anchor" href="#second-implementation"></a>6. Second Implementation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In our first implementation, object concepts was adapted in a way more or less extend. n our first implementation, object concepts was adapted in a way more or less extend.
Now, it’s time to improve this first implementation thanks to the use of the Interface instruction.</p>
</div>
<div class="sect2">
<h3 id="notion-of-object-interface"><a class="anchor" href="#notion-of-object-interface"></a>6.1. Notion of Object interface:</h3>
<div class="paragraph">
<p>The purpose of encapsulation is first to make visible, to the user, part of an object contents.
The visible part of the contents is called interface, the hidden part is called implementation.</p>
</div>
<div class="paragraph">
<p>Thus, the object interface is the only input-output access that the user has to act on an object.</p>
</div>
<div class="paragraph">
<p>It is the responsibility that I’m going to give in our use of the Interface instruction.</p>
</div>
<div class="paragraph">
<p>The Interface instruction allows to group under the same name, all or part of the methods from an object that the user will have the right access.</p>
</div>
</div>
<div class="sect2">
<h3 id="object-instanciation-and-object-constructor"><a class="anchor" href="#object-instanciation-and-object-constructor"></a>6.2. Object Instanciation and Object Constructor</h3>
<div class="paragraph">
<p>Play with an interface involve three steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>an Interface describing the required methods,</p>
</li>
<li>
<p>a structure describing the pointers of the corresponding functions,</p>
</li>
<li>
<p>a table of the methods: a structured variable initialized with the required functions adresses.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Step 1, consists in specify the object Interface, which is not a difficulty. Just name methods.</p>
</div>
<div class="paragraph">
<p>Steps 2 and 3 are linked. In our object approach, we already have the adapted Structure: it is the one who describes the Class of an object.
Moreover, the Interface and the Class of an object are close: both contain functions pointers.
Simply, the Interface instruction doesn’t contain the attributes of the Class but only all or any of the methods of the Class.</p>
</div>
<div class="paragraph">
<p>Thus it is completely possible to use the Class of an object to initialize the Interface. This step is the most natural. Let us remind that the interface is the visible part of the Class of an object, it is natural that the Class determines the Interface.</p>
</div>
<div class="paragraph">
<p>To see how to process, let me resume the example of the Rectangle2 class which provided a Draw() and Erase() methods.</p>
</div>
<div class="paragraph">
<p>The corresponding Class is the following one</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Structure Rectangle2
  *Draw
  *Erase
  x1.l
  x2.l
  y1.l
  y2.l
EndStructure

Procedure Draw_Rectangle(*this.Rectangle2)
  ; [ ...some code... ]
EndProcedure

Procedure Erase_Rectangle(*this.Rectangle2)
  ; [ ...some code... ]
EndProcedure</code></pre>
</div>
</div>
<div class="paragraph">
<p>The associated Interface is the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Interface Rectangle
  Draw()
  Erase()
EndInterface</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because the user may handle an object only through the interface, the object must be created directly from the interface Rectangle rather than class Rectangle2.</p>
</div>
<div class="paragraph">
<p>The object will thus be create by writing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Rect.Rectangle</code></pre>
</div>
</div>
<div class="paragraph">
<p>instead of Rect.Rectangle2 .</p>
</div>
<div class="paragraph">
<p>However, you should not forget to connect the Interface to the Class.
For this, it is necessary to initialize the Rect object during the statement.
Correction made, the good instruction to assign the object is the following one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Rect.Rectangle = New_Rect(0, 10, 0, 20)</code></pre>
</div>
</div>
<div class="paragraph">
<p>New_Rect() is a function which performs the initialization operation.
What it’s already known about it, it’s that the returned value is the memory address containing the functions addresses to be processed by the interface.</p>
</div>
<div class="paragraph">
<p>Here is the body of the New_Rect() function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Procedure New_Rect(x1.l, x2.l, y1.l, y2.l)
  *Rect.Rectangle2 = AllocateMemory(SizeOf(Rectangle2))

  *Rect \Draw = @Draw_Rectangle()
  *Rect \Erase = @Erase_Rectangle(

  *Rect\x1 = x1
  *Rect\x2 = x2
  *Rect\y1 = y1
  *Rect\y2 = y2

  ProcedureReturn *Rect
EndProcedure</code></pre>
</div>
</div>
<div class="paragraph">
<p>This function assigns a memory area of size the object Class size.
Then it initializes the methods and the attributes of the object.
It ends by retrieving the memory area address.
Because the addresses of Draw() and Erase() functions are first positioned in this memory area, the interface is effectively initialized.</p>
</div>
<div class="paragraph">
<p>To access to the Rect object methods, just write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Rect\Draw()
Rect\Erase()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, the demonstration is made that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Class Rectangle2 allows the object Interface initialization.</p>
</li>
<li>
<p>Rect, declared thanks the interface, is an object of the Class Rectangle2 which can use the Draw() and the Erase() methods.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Thus the Interface instruction and the New_Rect() function perform the instanciation of an Rect object from the Class Rectangle2.
The New_Rect() function is called as the object Constructor of the Class Rectangle2.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>All the Methods implementations (<code>Procedure</code>/<code>EndProcedure</code> blocks) must contain, as first argument, the <code>*this</code> pointer of the object. On the other hand, the <code>*this</code> argument mustn’t appear at the Interface level. In fact, as this instruction allows to write <code>Rect\Draw()</code>, it knows that the <code>Draw()</code> method involves the <code>Rect</code> object: no ambiguity! Everything happens as if the object <code>Rect</code> was «aware» of its state.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Constructor could receive, as parameters, the whole functions addresses which implement the methods. It is not the case here because we know the implemented methods: the ones from the class. On the other hand the initial state wished by the user is unkown. Thus, the Constructor may contain parameters for the attributes initialization.
It is the case here: the entries required by <code>New_Rect()</code> are the two coordinates (<code>x1</code>, <code>y1</code>) and (<code>x2</code>, <code>y2</code>) of the diametrically opposite points of the rectangle.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="object-initialization"><a class="anchor" href="#object-initialization"></a>6.3. Object Initialization</h3>
<div class="paragraph">
<p>After the required memory area for an object assigned, the Constructor initializes the various members of the object (methods and attributes).
This operation will be isolated in a specific procedure called by the Constructor.
By the way the distinction is made between the memory allocation and the object initialization. This is very useful to achieve afterward the concept of inheritance, because a single memory allocation is sufficient, but several initializations are required.</p>
</div>
<div class="paragraph">
<p>In addition, the initialization of the methods and of the attributes are separated too. It’s because the methods implementation depends on the class, while the attributes initialization depends on the object itself (see previous remark).</p>
</div>
<div class="paragraph">
<p>In our example, the two initialization procedures will be implemented as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Procedure Init_Mthds_Rect(*Rect.Rectangle2)
  *Rect\Draw = @Draw_Rectangle()
  *Rect\Erase = @Erase_Rectangle()
EndProcedure

Procedure Init_Mbers_Rect(*Rect.Rectangle2, x1.l, x2.l, y1.l, y2.l)
  *Rect\x1 = x1
  *Rect\x2 = x2
  *Rect\y1 = y1
  *Rect\y2 = y2
EndProcedure</code></pre>
</div>
</div>
<div class="paragraph">
<p>and the Constructor became:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Procedure New_Rect(x1.l, x2.l, y1.l, y2.l)
  *Rect = AllocateMemory(SizeOf(Rectangle2))
  Init_Mthds_Rect(*Rect)
  Init_Mbers_Rect(*Rect, x1, x2, y1, y2)
  ProcedureReturn *Rect
EndProcedure</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="object-destructor"><a class="anchor" href="#object-destructor"></a>6.4. Object Destructor</h3>
<div class="paragraph">
<p>Always associated to an object Constructor is the object Destructor.
During the construction of an object, a memory area is assigned to store the method and attribute definitions.
When an object is useless, it must be destroy to free the computer memory.
This process is performed by using a specific function called Destructor of the object.</p>
</div>
<div class="paragraph">
<p>In our example of Rectangle2 objects, the Destructor is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Procedure Free_Rect(*Rect)
  FreeMemory(*Rect)
EndProcedure</code></pre>
</div>
</div>
<div class="paragraph">
<p>and will be used as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Free_Rect(Rect2)</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Destructor could be seen as a method of the object. But to avoid weighing down the object and to preserve homogeneity with the Constructor, I have chosen to see it as a function of the Class.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To delete an object by its Destructor means releasing the memory area which containing the object information (methods to use and attributes states) but not deleting the object infrastructure.
So, in our example, having made:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Free_Rect(Rect2)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Rect2 can be reuse without specify its type again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Rect2 = New_Rect(0, 10, 0, 20)
Rect2\Draw()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Definitely, when an object instanciation is realized, as hereafter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Rect2.Rectangle</code></pre>
</div>
</div>
<div class="paragraph">
<p>the life cycle of object <code>Rect2</code> follows the same rules as those of the variables because Rect2 is at first a variable: it is a structured variable continuing the functions pointers of the object methods. (See also the reminder which follows)</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Small reminder: the life cycle of a variable is linked to the life cycle of the program part where the variable is declared:</p>
</div>
<div class="paragraph">
<p>If the variable is declared inside a procedure, its life cycle will be linked to that of the procedure, which is equal to the function time of use.
If the variable is declared outside any procedure, in the program’s main core, its life cycle is linked to that of the program.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="memory-allocations"><a class="anchor" href="#memory-allocations"></a>6.5. Memory Allocations</h3>
<div class="paragraph">
<p>In every new instanciation, the Constructor has to allocate dynamically a memory area according the size of the information describing the object.
For that purpose, the Constructor should use the <code>AllocateMemory()</code> command associated with <code>FreeMemory()</code> command for the Destructor.
But there is other candidate to achieve such dynamic memory allocation.
Under Windows OS, API can be directly used for example.</p>
</div>
<div class="paragraph">
<p>Standard PureBasic library provides linked lists, which also a good candidate to allocate dynamically some memory.</p>
</div>
</div>
<div class="sect2">
<h3 id="encapsulation-3"><a class="anchor" href="#encapsulation-3"></a>6.6. Encapsulation</h3>
<div class="paragraph">
<p>Let us imagine now that I want to give to the user only access to the <code>Draw()</code> method of the Class <code>Rectangle</code>. I shall begin by defining the wished interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Interface Rectangle
  Draw()
EndInterface</code></pre>
</div>
</div>
<div class="paragraph">
<p>To instanciate a new object I write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Rect.Rectangle = New_Rect()</code></pre>
</div>
</div>
<div class="paragraph">
<p>with,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Procedure Init_Mthds_Rect(*Rect.Rectangle2)
  *Rect\Draw = @Draw_Rectangle()
  *Rect\Erase = @Erase_Rectangle()
EndProcedure

Procedure Init_Mbers_Rect(*Rect.Rectangle2, x1.l, x2.l, y1.l, y2.l)
  *Rect\x1 = x1
  *Rect\x2 = x2
  *Rect\y1 = y1
  *Rect\y2 = y2
EndProcedure

Procedure New_Rect(x1.l, x2.l, y1.l, y2.l)
  *Rect = AllocateMemory(SizeOf(Rectangle2))
  Init_Mthds_Rect(*Rect)
  Init_Mbers_Rect(*Rect, x1, x2, y1, y2)
  ProcedureReturn *Rect
EndProcedure</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is similar as previous because the first function address is the <code>Draw()</code> method one.</p>
</div>
<div class="paragraph">
<p>Now, imagine that I want to give to the user only the access to the <code>Erase()</code> method. I shall begin by defining the new interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Interface Rectangle
  Erase()
EndInterface</code></pre>
</div>
</div>
<div class="paragraph">
<p>Nevertheless to instanciate the new object I cann’t use the <code>New_Rect()</code> Constructor above.
In the opposite case, the result would be identical to the previous case. By writting <code>Rect\Erase()</code> the <code>Draw()</code> method is called.</p>
</div>
<div class="paragraph">
<p>Thus, a new Constructor is needed able to return the correct function address.</p>
</div>
<div class="paragraph">
<p>Hereafter one of them is given:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Procedure Init_Mthds_Rect2(*Rect.Rectangle2)
  *Rect\Draw = @Erase_Rectangle()
  *Rect\Erase = @Draw_Rectangle()
EndProcedure

Procedure Init_Mbers_Rect(*Rect.Rectangle2, x1.l, x2.l, y1.l, y2.l)
  *Rect\x1 = x1
  *Rect\x2 = x2
  *Rect\y1 = y1
  *Rect\y2 = y2
EndProcedure

Procedure New_Rect2(x1.l, x2.l, y1.l, y2.l)
  *Rect = AllocateMemory(SizeOf(Rectangle2))
  Init_Mthds_Rect2(*Rect)
  Init_Mbers_Rect(*Rect, x1, x2, y1, y2)
  ProcedureReturn *Rect
EndProcedure</code></pre>
</div>
</div>
<div class="paragraph">
<p>You notice that the functions addresses were just inverted at the initialization level.
Certainly, it is not very elegant to allocate Draw field of the Rectangle2 Structure with an other function address.
If it allows to preserve the same Structure, that of the Class, it also underlines a matter:
The function pointer names are less interesting than their values!
To erase this non-problem, just rename the pointers of the Class as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Structure Rectangle2
  *Method1
  *Method2
  x1.l
  x2.l
  y1.l
  y2.l
EndStructure</code></pre>
</div>
</div>
<div class="paragraph">
<p>In fact, the Interface and the Constructor are in charge to give a sense to these pointers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>by giving them a name (task of the interface)</p>
</li>
<li>
<p>by allocating them the adequate functions addresses (task of the constructor)</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In spite of this arrangement concerning the function pointer names, it remains more practical to keep an explicit name if hiding methods is not considered (what is the most common situation). That allows to modify a Mother Class without retouching the pointers numbering of the Child Classes.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="inheritance-3"><a class="anchor" href="#inheritance-3"></a>6.7. Inheritance</h3>
<div class="paragraph">
<p>As for the first inheritance concept implementation, let takes advantage that the Structure and Interface instructions have to be extend thanks to the keyword Extends.</p>
</div>
<div class="paragraph">
<p>So, to pass from the Rectangle1 Class which has a single Draw() method to…</p>
</div>
<div class="listingblock">
<div class="title">Interface</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Interface Rect1
  Draw()
EndInterface</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Class</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Structure Rectangle1
  *Method1
  x1.l
  x2.l
  y1.l
  y2.l
EndStructure

Procedure Draw_Rectangle(*this.Rectangle1)
  ; [ ...some code... ]
EndProcedure

Procedure Init_Mthds_Rect1(*Rect.Rectangle1)
  *Rect\Method1 = @Draw_Rectangle()
EndProcedure</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Constructor</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Procedure Init_Mbers_Rect1(*Rect.Rectangle1, x1.l, x2.l, y1.l, y2.l)
  *Rect\x1 = x1
  *Rect\x2 = x2
  *Rect\y1 = y1
  *Rect\y2 = y2
EndProcedure

Procedure New_Rect1(x1.l, x2.l, y1.l, y2.l)
  *Rect = AllocateMemory(SizeOf(Rectangle1))
  Init_Mthds_Rect1(*Rect)
  Init_Mbers_Rect1(*Rect, x1, x2, y1, y2)
  ProcedureReturn *Rect
EndProcedure</code></pre>
</div>
</div>
<div class="paragraph">
<p>…a Rectangle2 Class, which have two methods: Draw() and Erase(), write:</p>
</div>
<div class="listingblock">
<div class="title">Interface</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Interface Rect2 Extends Rect1
  Erase()
EndInterface</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Class</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Structure Rectangle2 Extends Rectangle1
  *Method2
EndStructure

Procedure Erase_Rectangle(*this.Rectangle1)
  ; [ ...some code... ]
EndProcedure

Procedure Init_Mthds_Rect2(*Rect.Rectangle2)
  Init_Mthds_Rect1(*Rect)
  *Rect\Method2 = @Erase_Rectangle()
EndProcedure</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Constructor</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Procedure Init_Mbers_Rect2(*Rect.Rectangle2, x1.l, x2.l, y1.l, y2.l)
  Init_Mbers_Rect1(*Rect, x1, x2, y1, y2)
EndProcedure

Procedure New_Rect2(x1.l, x2.l, y1.l, y2.l)
  *Rect = AllocateMemory(SizeOf(Rectangle2))
  Init_Mthds_Rect2(*Rect)
  Init_Mbers_Rect2(*Rect, x1, x2, y1, y2)
  ProcedureReturn *Rect
EndProcedure</code></pre>
</div>
</div>
<div class="paragraph">
<p>Carrying out an inheritance consists in extending Interface and Class structure, but also in adapting the method and the attribut initializations
Both procedures Init_Mthds_Rect2() and Init_Mbers_Rect2() call respectively the initialization of the methods and to the initialization of the attributes of the Class Rectangle1 ( Init_Mthds_Rect1() and Init_Mbers_Rect1() ) rather than the Constructor New_Rect1().
Those because, a Child Class object doesn’t need to instantiate a Mother Class object but just to inherit methods and attributes.</p>
</div>
<div class="paragraph">
<p>On the other side, verification is made that the Child Class benefits immediately of any changes made at the Mother Class level (adding a method or a variable).</p>
</div>
<div class="paragraph">
<p>Is the inheritance currently correct? No, because it doesn’t allow the object of the Child Class (Rectangle2) to use the new Erase() method.
The reason takes place on that function pointer *Methode2 doesn’t follow the *Methode1 one.</p>
</div>
<div class="paragraph">
<p>Let me show you the explicit form of Class Rectangle2 Structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Structure Rectangle2
  *Method1
  x1.l
  x2.l
  y1.l
  y2.l
  *Method2.l
EndStructure</code></pre>
</div>
</div>
<div class="paragraph">
<p>instead of having the Structure below, authorizing a correct initialization of the interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Structure Rectangle2
  *Method1
  *Method2
  x1.l
  x2.l
  y1.l
  y2.l
EndStructure</code></pre>
</div>
</div>
<div class="paragraph">
<p>Remind that a correct interface initialization needs functions addresses, which follow each other ().
To resolve this problem, just group all the methods into a specific structure !
The Class structure needs just to have a pointer on this new structure as the following example shows:</p>
</div>
<div class="listingblock">
<div class="title">Interface</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Interface Rect1
  Draw()
EndInterface</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Class</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Structure Rectangle1
  *Methods
  x1.l
  x2.l
  y1.l
  y2.l
EndStructure

Procedure Draw_Rectangle(*this.Rectangle1)
  ; [ ...some code... ]
EndProcedure

Structure Methd_Rect1
  *Method1
EndStructure

Procedure Init_Mthds_Rect1(*Mthds.Mthds_Rect1)
  *Mthd_Rect1\Method1 = @Draw_Rectangle()
EndProcedure

Mthds_Rect1. Mthds_Rect1
Init_Mthds_Rect1(@Mthds_Rect1)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Constructor</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Procedure Init_Mbers_Rect1(*Rect.Rectangle1, x1.l, x2.l, y1.l, y2.l)
  *Rect\x1 = x1
  *Rect\x2 = x2
  *Rect\y1 = y1
  *Rect\y2 = y2
EndProcedure

Procedure New_Rect1(x1.l, x2.l, y1.l, y2.l)
  Shared Mthds_Rect1
  *Rect.Rectangle1 = AllocateMemory(SizeOf(Rectangle1))
  *Rect\Methods = @Mthds_Rect1
  Init_Mbers_Rect1(*Rect, x1, x2, y1, y3)
  ProcedureReturn *Rect
EndProcedure</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Methd_Rect1</code> structure describes all the functions pointers of the Class methods.
Follows the Methd_Rect1 variable statement and its initialization thanks to Init_Mthds_Rect1().</p>
</div>
<div class="paragraph">
<p>Methd_Rect1 is called the table of the methods of the call. This variable contains the whole methods adresses.
Here is reached the final Class methods description.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The following expression</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Mthds_Rect1.Mthds_Rect1
Init_Mthds_Rect1(@Mthds_Rect1)</code></pre>
</div>
</div>
<div class="paragraph">
<p>can be condensate into</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Init_Mthds_Rect1(@Mthds_Rect1.Mthds_Rect1)</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Rectangle1 structure, contains now a pointer "*Methods", initialized through the constructor by giving to it the Methd_Rect1 variable address.</p>
</div>
<div class="paragraph">
<p>The inheritance can be now performed correctly, because by extending the Methd_Rect1 Structure in a Methd_Rect2 new one, the addresses of functions are going to follow each other:</p>
</div>
<div class="listingblock">
<div class="title">Interface</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Interface Rect2 Extends Rect1
  Erase()
EndInterface</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Class</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Structure Rectangle2 Extends Rectangle1
EndStructure

Procedure Erase_Rectangle(*this.Rectangle2)
  ; [ ...some code... ]
EndProcedure

Structure Methd_Rect2 Extends Methd_Rect1
  *Method2
EndStructure

Procedure Init_Mthds_Rect2(*Mthds.Mthds_Rect2)
  Init_Mthds_Rect1(*Mthds)
  *Mthd_Rect2\Method2 = @Erase_Rectangle()
EndProcedure

Mthds_Rect2. Mthds_Rect2
Init_Mthds_Rect2(@Mthds_Rect2)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Constructor</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Procedure Init_Mbers_Rect2(*Rect.Rectangle2 , x1.l, x2.l, y1.l, y2.l)
  Init_Mbers_Rect1(*Rect, x1, x2, y1, y2)
EndProcedure

Procedure New_Rect2(x1.l, x2.l, y1.l, y2.l)
  Shared Mthds_Rect2
  *Rect.Rectangle2 = AllocateMemory(SizeOf(Rectangle2))
  *Rect\Methods = @Mthds_Rect2
  Init_Mbers_Rect2(*Rect, x1, x2, y1, y2)
  ProcedureReturn *Rect
EndProcedure</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the Rectangle2 Structure is empty and it isn’t a problem.
Two reasons in it:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>At first the *Methodes pointer needs to exist only once and this in the Mother Class.</p>
</li>
<li>
<p>Then, no supplementary attributes have been added to it.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>there is three advantages to have a methods initialization routine external to the Constructor and a table of methods available in a single variable:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The table of the methods are initialized once and not at each object instanciation,</p>
</li>
<li>
<p>The objects have no more than one pointer towards the methods: it is a substantial gain of memory,</p>
</li>
<li>
<p>All the objects referred towards the same table of methods, which guaranteed an identical behavior for all the objects of the same Class.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="get-and-set-object-methods"><a class="anchor" href="#get-and-set-object-methods"></a>6.8. Get() and Set() object methods</h3>
<div class="paragraph">
<p>By Interface, it is possible to use only methods of an object.
The interface encapsulates completely the object attributes.
To act on attributes, either for examine or to modify them, it is necessary to give specific methods to the user.
The methods allowing to examine object attributes are called Get() methods.
The methods allowing to modify object attributes are called Set() methods.</p>
</div>
<div class="paragraph">
<p>In our example of Rectangle1 Class, if I want to examine the value of the attribute var2, I should create the following Get() method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Procedure Get_var2(*this.Rectangle1)
  ProcedureReturn *this\var2
EndProcedure</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also, to modify the value of the attribute var2, I should write the following Set() method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Procedure Set_var2(*this.Rectangle1, value)
  *this\var2 = value
EndProcedure</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because Get() and Set() methods exist only to allow the user to modify all or any of the object attributes, they are necessarily present in the Interface.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>See the <a href="#optimisations">Appendix</a> of the tutorial for possible optimization.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synthesis-and-notation"><a class="anchor" href="#synthesis-and-notation"></a>7. Synthesis and notation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before I present the selected Class implementation, I’m going to spend a little time summarizing the work made under a formal notation frame. The implementation of an object involve the following elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An Interface,</p>
</li>
<li>
<p>A Class (concrete / abstract) including the methods definition,</p>
</li>
<li>
<p>A Constructor provided with a routine initializating attributes,</p>
</li>
<li>
<p>A Destructor.
The following table summarizes what is our object in PureBasic.</p>
</li>
<li>
<p>The word Class refers to the name of the Class (ex: Methd_Class)</p>
</li>
<li>
<p>The word Mother refers to the name of the Mother Class during an inheritance (ex: Methd_ MotherClass)</p>
</li>
<li>
<p>The expressions between embraces {} are to be used during an inheritance</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Interface</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic pseudocode" data-lang="purebasic pseudocode">Interface &lt;Interface&gt; {Extends &lt;MotherInterface&gt;}
  Method1()
  [Method2()]
  [Method3()]
  ...
EndInterface</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Class</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic pseudocode" data-lang="purebasic pseudocode">Structure &lt;Class&gt; {Extends &lt;MotherClass&gt;}
  *Methods
  [Attribute1]
  [Attribute2]
  ...
EndStructure

Procedure Method1(*this.Class, [arg1]...)
  ...
EndProcedure

Procedure Method2(*this.Class, [arg1]...)
  ...
EndProcedure
...

Structure &lt;Mthds_Class&gt; {Extends &lt;Mthds_MotherClass&gt;}
  *Method1
  *Method2
  ...
EndStructure

Procedure Init_Mthds_Class(*Mthds.Mthds_Class)
  {Init_Mthds_MotherClass(*Mthds)}
  *Mthds\Method1 = @Method1()
  *Mthds\Method2 = @Method2()
  ...
EndProcedure

Mthds_Class.Mthds_Class
Init_Mthds_Class(@Mthds_Class)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Constructor</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic pseudocode" data-lang="purebasic pseudocode">Procedure Init_Mbers_Class(*this.Class, [var1]...)
  {Init_Mbers_MotherClass(*this)}
  [*this\Attibute1 = var1]
  ...
EndProcedure

Procedure New_Class([var1]...)
  Shared Mthds_Class
  *this.Class = AllocateMemory(SizeOf(Class))
  *this\Methods = @Mthds_Class
  Init_Mbers_Class(*this, [var1]...)
  ProcedureReturn *this
EndProcedure</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Destructor</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic pseudocode" data-lang="purebasic pseudocode">Procedure Free_Class(*this)
  FreeMemory(*this)
EndProcedure</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="first-code-example"><a class="anchor" href="#first-code-example"></a>7.1. First Code-Example</h3>
<div class="paragraph">
<p>Here is an example of a code where the inheritance is used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="OOP-Inheritance-Ex1.pb"><code>OOP-Inheritance-Ex1.pb</code></a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="pb-class"><a class="anchor" href="#pb-class"></a>8. PB Class</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now we saw OOP concepts and their possible implementations in PureBasic, it’s time to establish an implementation.</p>
</div>
<div class="paragraph">
<p>Here I present an implementation which seems to me, according to my current knowledge, the most adapted to the OOP by the way of PureBasic.</p>
</div>
<div class="paragraph">
<p>It is based on the whole work exposed previously but also of my own experience of the practice of the subject.
The other goal is to tend to simplify the use of object concepts, by clear commands and by automating operations as much as possible.
In this step, macros are going to play a decisive role.
Greatly facilitated by Interface and Macro commands, the proposed implementation remains naturally limited by the language itself.</p>
</div>
<div class="paragraph">
<p>At first, I’ll present the instructions of a Class in PureBasic. Then I’ll analyze what hides behind by firing parallels with the previous pages. This chapter ended on a discussion of the choices made.</p>
</div>
<div class="sect2">
<h3 id="purebasic-class"><a class="anchor" href="#purebasic-class"></a>8.1. PureBasic Class</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic pseudocode" data-lang="purebasic pseudocode">; Object class
Class(&lt;ClassName&gt;)
  [Method1()]
  [Method2()]
  [Method3()]
  ...
  Methods(&lt;ClassName&gt;)
    [&lt;*Method1&gt;]
    [&lt;*Method2&gt;]
    [&lt;*Method3&gt;]
    ...
  Members(&lt;ClassName&gt;)
    [&lt;Attribute1&gt;]
    [&lt;Attribute2&gt;]
    ...
EndClass(&lt;ClassName&gt;)

; Object methods (implementation)
Method(&lt;ClassName&gt;, Method1) [,&lt;variable1 [= DefaultValue]&gt;,...])
  ...
  [ProcedureReturn value]
EndMethod(&lt;ClassName&gt;, Method1)

...(ditto for each method)

; Object constructor
New(&lt;ClassName&gt;)
  ...
EndNew

; Object destructor
Free(&lt;ClassName&gt;)
  ...
EndFree</code></pre>
</div>
</div>
<div class="paragraph">
<p>As shown, the PureBasic Class is articulated with four main subjects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The definition of the class with Class : EndClass block,</p>
</li>
<li>
<p>The implementation of the methods of the class with Method: EndMethod block,</p>
</li>
<li>
<p>The construction of the object with New : EndNew block,</p>
</li>
<li>
<p>The destructor of the object with Free : EndFree block.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="second-code-example"><a class="anchor" href="#second-code-example"></a>8.2. Second Code-Example</h3>
<div class="paragraph">
<p>You will find here the files containing the declaration of this set of commands as well as an example file of use based on the inheritance example, what will allow you to compare with <a href="#first-code-example">previous implementation</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="OOP.pbi"><code>OOP.pbi</code></a></p>
</li>
<li>
<p><a href="OOP-Inheritance-Ex2.pb"><code>OOP-Inheritance-Ex2.pb</code></a></p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you have already looked at the source code from the <code>OOP.pbi</code> file, you are going to notice that the final OOP implementation in the source is a little more complicated than the basic explanation from this acticle. This is because some arrangements are made to service update of the source.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let me run you through the Purebasic Class declaration&#8230;&#8203;</p>
</div>
</div>
<div class="sect2">
<h3 id="class-endclass"><a class="anchor" href="#class-endclass"></a>8.3. Class : EndClass</h3>
<div class="paragraph">
<p><code>Class</code> : <code>EndClass</code> block allows declaring three types of constituents:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The interface of the object, only part that the user can handle.</p>
</li>
<li>
<p>The methods of the object -except implementation- which are reduced to the pointers of the methods.</p>
</li>
<li>
<p>Members (except methods) of the object. Afterward, words 'member' and more correctly 'attribute' will often make reference to these only elements (and not to the methods which are also members of the object in the strict meaning).</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic pseudocode" data-lang="purebasic pseudocode">; Object class
Class(&lt;ClassName&gt;)
  [Method1()]
  [Method2()]
  [Method3()]
  ...
  Methods(&lt;ClassName&gt;)
    [&lt;*Method1&gt;]
    [&lt;*Method2&gt;]
    [&lt;*Method3&gt;]
    ...
  Members(&lt;ClassName&gt;)
    [&lt;Attribute1&gt;]
    [&lt;Attribute2&gt;]
    ...
EndClass(&lt;ClassName&gt;)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each constituent is clearly identified with keywords: Class\Methods\Members. This order must be preserved and keywords always have to appear even though any method or member will not be declared. Also, at each time the name of the class is a parameter of the keyword.</p>
</div>
<div class="paragraph">
<p>The explanation takes place in the definition of every keyword. Here is the code:</p>
</div>
<div class="sect3">
<h4 id="class-keyword"><a class="anchor" href="#class-keyword"></a>8.3.1. Class keyword</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Macro Class(ClassName)
  ; Declare the class interface
  Interface ClassName#_
EndMacro</code></pre>
</div>
</div>
<div class="paragraph">
<p>The keyword Class declares just the header of the interface statement. The name of the interface comes from the class name merged with "_". So what follows Class will be the definition of the interface of the object.</p>
</div>
</div>
<div class="sect3">
<h4 id="methods-keyword"><a class="anchor" href="#methods-keyword"></a>8.3.2. Methods keyword</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Macro Methods(ClassName)
  EndInterface
  ; Declare the methods table structure
  Structure Mthds_#ClassName
EndMacro</code></pre>
</div>
</div>
<div class="paragraph">
<p>The keyword Methods begins by closing the definition of the interface with EndInterface. Then it opens the statement of the structure which defined the pointers of the methods.</p>
</div>
</div>
<div class="sect3">
<h4 id="members-keyword"><a class="anchor" href="#members-keyword"></a>8.3.3. Members keyword</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Macro Members(ClassName)
  EndStructure
  ; Create the methods table
  Mthds_#ClassName.Mthds_#ClassName
  ; Declare the members
  ; No parent class: implement pointers for the Methods and the instance
  Structure Mbrs_#ClassName
    *Methods
    *Instance.ClassName
EndMacro</code></pre>
</div>
</div>
<div class="paragraph">
<p>The keyword Members is more complicated than the two previous ones.</p>
</div>
<div class="paragraph">
<p>It begins by closing the definition of the structure first opened by Methods. Then it declares the table of the methods based on the structure freshly built. For the moment this table is empty and will be fill a the end of <code>Method</code> : <code>EndMethod</code> statement. I’ll be discussing this farther (I can’t wait).</p>
</div>
<div class="paragraph">
<p>Finally Members ends by opening the structure declaration which defined the members of the object. At first position -as expected- is the pointer to the table of the methods, i.e. to the variable just above. The assignment is done later by the constructor. Follows another pointer which will contain the address of the object itself. I shall explain later the reason of this new member (not! Now).</p>
</div>
<div class="paragraph">
<p>It remains for the user simply to declare the other members of the object next Members keyword.</p>
</div>
</div>
<div class="sect3">
<h4 id="endclass-keyword"><a class="anchor" href="#endclass-keyword"></a>8.3.4. EndClass keyword</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Macro EndClass(ClassName)
  EndStructure

  Structure ClassName
    StructureUnion
      *Md.ClassName#_     ; its methods
      *Mb.Mbrs_#ClassName ; its memebers
    EndStructureUnion
  EndStructure
EndMacro</code></pre>
</div>
</div>
<div class="paragraph">
<p>EndClass keyword code is at the origin of the implementation chosen for our object. So I’m now going to describe it correctly.</p>
</div>
<div class="paragraph">
<p>As for Methods and Members, it begins by closing what was opened by the previous keyword, here the structure describing the members of the object.</p>
</div>
<div class="paragraph">
<p>Then, follows the structure called with the name of the class and which will be use to instanciate the object.</p>
</div>
<div class="paragraph">
<p>This structure is in fact the union of two elements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The first is a pointer typed by the interface which allows to call the methods of the object.</p>
</li>
<li>
<p>The second is a pointer typed by the structure defining members. It helps in acting on the members of the object.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This design puts into practice optimization on the accessors exposed in appendix. The benefit of this choice is double:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It provides a same process to reach methods and members of an object.</p>
<div class="paragraph">
<p>To reach a method, write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">*Rect\Md\Draw()</code></pre>
</div>
</div>
<div class="paragraph">
<p>To reach a attribute, write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">*Rect\Mb\var1</code></pre>
</div>
</div>
</li>
<li>
<p>It avoids to declare systematically Get and Set methods of an object when they are ordinary. That saves time and it’s practical. At the same moment, that limits the numbers of methods of an object (small optimization).</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The price of this choice is that all the members of an object are visible by the user.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This structure could be adapted a little. As terms ' Md ' and ' Mb ' are visually very close, a better distinguish could be studied. Although this choice was not retain, here is an interesting possibility:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Structure ClassName
  StructureUnion
    *Md.ClassName#_       ; methods
    *Get.Mbrs_#ClassName  ; used to read a member
    *Set.Mbrs_#ClassName  ; used to modify a member
  EndStructureUnion
EndStructure</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this code, the pointer *Mb was replaced by two pointers *Get and *Set. They have the same functionality but they can lead to a more legible code by clarifying if an attribute is readed or modified.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="method-endmethod"><a class="anchor" href="#method-endmethod"></a>8.4. Method : EndMethod</h3>
<div class="paragraph">
<p><code>Method</code> : <code>EndMethod</code> block allows to acheive the implementation of the various methods of an object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic pseudocode" data-lang="purebasic pseudocode">; Object methods (implementation)
Method(&lt;ClassName&gt;, Method1) [,&lt;variable1 [= DefaultValue]&gt;,...])
  ...
  [ProcedureReturn value]
EndMethod(&lt;ClassName&gt;, Method1)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each keyword has the class name and the method name as parameters.</p>
</div>
<div class="paragraph">
<p>In use, Method : EndMethod works like Procedure: EndProcedure. In fact it is a wrap of this block as exposed hereafter.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note the very special syntax of the method which requires two closed brackets. This specificity comes from the use of a macro combined with a different number of possible arguments for each method.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="method-keyword"><a class="anchor" href="#method-keyword"></a>8.4.1. Method keyword</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Macro Method(ClassName, Mthd)
  Procedure Mthd#_#ClassName(*this.Mbrs_#ClassName
EndMacro</code></pre>
</div>
</div>
<div class="paragraph">
<p>Method keyword is not more than a Procedure keyword where are pre-declared the variable *this required as first argument.</p>
</div>
<div class="paragraph">
<p>Code doesn’t end by a bracket to allow the user to complete it by the specific parameters of its method. Up to him to close this bracket as shown in the syntax, otherwise the compiler will not miss to notify this!</p>
</div>
</div>
<div class="sect3">
<h4 id="endmethod-keyword"><a class="anchor" href="#endmethod-keyword"></a>8.4.2. EndMethod keyword</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Macro EndMethod(ClassName, Mthd)
  EndProcedure
  ; Save the method’s address into the methods table
  Mthds_#ClassName\Mthd=@Mthd#_#ClassName()
EndMacro</code></pre>
</div>
</div>
<div class="paragraph">
<p>EndMethod keyword begins by closing the procedure opened by the Method keyword.
Once the method defined, it can be referenced into the table of methods (declared by the Members keyword of the class). Actually, by declaring a method, this method is automatically referenced.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="object-constructor"><a class="anchor" href="#object-constructor"></a>8.5. Object Constructor</h3>
<div class="paragraph">
<p>New : EndNew block allows to instanciate a new object of the class by declaring and initialising.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic pseudocode" data-lang="purebasic pseudocode">; Object constructor
New(&lt;ClassName&gt;)
  ...
EndNew</code></pre>
</div>
</div>
<div class="paragraph">
<p>The New keyword has the class name as parameter.</p>
</div>
<div class="sect3">
<h4 id="new-keyword"><a class="anchor" href="#new-keyword"></a>8.5.1. New keyword</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Macro New(ClassName)
  Declare Init_Mbers_#ClassName(*this, *input.Mbrs_#ClassName=0)

  Procedure.l New_#ClassName(*input.Mbrs_#ClassName =0)
    Shared Mthds_#ClassName
    ; Allocate the memory required for the object members
    *this.Mbrs_#ClassName = AllocateMemory(SizeOf(Mbrs_#ClassName))
    ; Attach the methods table to the object
    *this\Methods=@Mthds_#ClassName
    ; The object is created then initialised
    ; Create the object
    *this\Instance= AllocateMemory(SizeOf(ClassName))
    *this\Instance\Md = *this
    ; Now init members
    Init_Mbers_#ClassName(*this, *input)
    ProcedureReturn *this\Instance
  EndProcedure

  Init_Mbers(ClassName)
EndMacro</code></pre>
</div>
</div>
<div class="paragraph">
<p>New keyword is dense but doesn’t change really compare to previous design.</p>
</div>
<div class="paragraph">
<p>The goal of this keyword is to create a new object and to initialise it. These tasks are performed into the New_ClassName procedure which is the main part of the New macro.</p>
</div>
<div class="paragraph">
<p>This procedure accepts a single argument, the one required by Init_Mbers for attributs initialisation.</p>
</div>
<div class="paragraph">
<p>It begins by allocated the memory space required for the members of the object.</p>
</div>
<div class="paragraph">
<p>Then it attaches to it the table of the methods of the class.</p>
</div>
<div class="paragraph">
<p>Next it performs the object instanciation by assigning an address to the object then by initializing the interface.</p>
</div>
<div class="paragraph">
<p>The initialization of the attributes of the object follows through Init_Mbers method.</p>
</div>
<div class="paragraph">
<p>Finally, New returns the address of the object.</p>
</div>
<div class="paragraph">
<p>The trick is that the New macro ends by the keyword Init_Mbers. Like this, what the user has to add inside the New : EndNew block is simply the attributs initialisation. More on that in a moment though (Give me now!).</p>
</div>
<div class="paragraph">
<p>This arrangement is possible thanks declaring the Init_Mbers method first in the macro.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Notice that the New_ClassName procedure is common to all kind of Class. It is because the variant part was externalized into Init_Mbers method.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="endnew-keyword"><a class="anchor" href="#endnew-keyword"></a>8.5.2. EndNew keyword</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Macro EndNew
  EndInit_Mbers
EndMacro</code></pre>
</div>
</div>
<div class="paragraph">
<p>EndNew keyword is limited to call the EndInit_Mbers keyword that end the statement of the attribut initialisation start at the end of the New macro.</p>
</div>
<div class="paragraph">
<p>Conclusion: the goal is reached. Through the New : EndNew block, we have a new object of the Class initialised (methods and attributs)</p>
</div>
<div class="paragraph">
<p>In use, the New : EndNew block allows the attibuts initialisation like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">New(Rect1)
*this\var1 = *input\var1
*this\var2 = *input\var2
; [ ...some code... ]
EndNew</code></pre>
</div>
</div>
<div class="paragraph">
<p>to instanciate an such object write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">input.Mbrs_Rect1
input\var1 = 10
input\var2 = 20

; *Rect is a new object from Rect1 class
*Rect.Rect1 = New_Rect1(input)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the constructor name is 'New' followed by the name of the class separated by "_".</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>With regard to what was studied until now, the object will always be a pointer. It doesn’t matter but it’s the consequence of the choice made in regrouping the access of the methods and the access of the members (What!? I don’t remember!).</p>
</div>
<div class="paragraph">
<p>The choice of the StructureUnion requires two different memory allocations: the one for the members and the one to regroup methods and members (4 bytes here).
This bivalence -which didn’t exist for the previous implementation- leads us to keep information into the object. So in the methods of the object, you could access to the address of members with *this and to the address of the instance (method and members) by *this\Instance.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It ensues an important feature by using *this\Instance to call the methods of the object within its methods (No I did not drink!). This feature is the best way to do this task because the name of the procedure behind the method isn’t really known, what is needed in the inheritance process.</p>
</div>
<div class="paragraph">
<p>For that purpose, a macro Mtd is directly proposed in source file OOP.pbi.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="init_mbers-endinit_mbers-private-block"><a class="anchor" href="#init_mbers-endinit_mbers-private-block"></a>8.5.3. Init_Mbers : EndInit_Mbers private block</h4>
<div class="paragraph">
<p>Init_Mbers: EndInit_Mbers block is a private block of the OOP implementation, used by the New : EndNew block to initilalise attributs of an object. But it is important to present this internal block to understand how an object initialisation will by specified.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic pseudocode" data-lang="purebasic pseudocode">; Attributes initialisation
Init_Mbers(&lt;ClassName&gt;)
  ...
EndInit_Mbers</code></pre>
</div>
</div>
<div class="paragraph">
<p>Between the two keywords are a series of member’s initialization.
Note that only Init_Mbers keyword requires the class name as parameter.</p>
</div>
<div class="sect5">
<h6 id="init_mbers-keyword"><a class="anchor" href="#init_mbers-keyword"></a>Init_Mbers keyword</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Macro Init_Mbers(ClassName)
  Method(ClassName, Init_Mbers), *input.Mbrs_#ClassName =0)
EndMacro</code></pre>
</div>
</div>
<div class="paragraph">
<p>Instruction Init_Mbers is defined as a method of the object accepting a single argument.</p>
</div>
<div class="paragraph">
<p>To initialize the object according to the wishes of the user and because the number of members couldn’t be known in advance, the choice was made to pass information by referent.</p>
</div>
<div class="paragraph">
<p>This choice is reinforced by the prejudice that the constructor has the responsibility to initialize the object (by calling this particular method).
Finally, but not the least, this disposal allows to automate the process of inheritance.</p>
</div>
<div class="paragraph">
<p>In use, the initialization of members will look like mostly what follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Init_Mbers(Rect1)
*this\var1 = *input\var1
*this\var2 = *input\var2
; [ ...some code... ]
EndInit_Mbers</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="endinit_mbers-keyword"><a class="anchor" href="#endinit_mbers-keyword"></a>EndInit_Mbers keyword</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Macro EndInit_Mbers
  EndProcedure
EndMacro</code></pre>
</div>
</div>
<div class="paragraph">
<p>EndInit_Mbers keyword is not more and not less that the EndProcedure keyword which ends the statement of the method of the object initialization.</p>
</div>
<div class="paragraph">
<p>If you are the impatient sort and have already looked at the source code, you may have noticed that the final update OOP implementation source file include extra optional parameters called arg1 to arg5. This is because in some situation, it is useful to complet the standard *input pointer by additional information.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="object-destructor-2"><a class="anchor" href="#object-destructor-2"></a>8.6. Object destructor</h3>
<div class="paragraph">
<p>Free: EndFree block allows to destroy object of the class and to restore memory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic pseudocode" data-lang="purebasic pseudocode">; Object destructor
Free(&lt;ClassName&gt;)
 ...
EndFree</code></pre>
</div>
</div>
<div class="paragraph">
<p>Free keyword has the class name as parameter.</p>
</div>
<div class="sect4">
<h5 id="free-endfree-block"><a class="anchor" href="#free-endfree-block"></a>Free:EndFree block</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Macro Free(ClassName)
  Procedure Free_#ClassName(*Instance.ClassName)
    If *Instance
EndMacro

Macro EndFree
      FreeMemory(*Instance\Md)
      FreeMemory(*Instance)
    EndIf
  EndProcedure
EndMacro</code></pre>
</div>
</div>
<div class="paragraph">
<p>Free:EndFree block is rather simple.</p>
</div>
<div class="paragraph">
<p>Free:EndFree block is rather simple.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Free opens a procedure with the object address as argument. In passing we check that it is a none null address (nevertheless it not guaranteed a valid address for FreeMemory() ).</p>
</li>
<li>
<p>EndFree releases sequentially the memory assigned to members then that of the object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In use, to free an object intance write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Free_Rect1(*Rect)</code></pre>
</div>
</div>
<div class="paragraph">
<p>As for the constructor, note that the destructor name is 'Free' followed by the name of the class separated by "_".</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If your object consists of other objects, i.e. that objects are members of the current object and exist by this object (hic!) it is important to free them too by calling their destructors between keywords Free and EndFree.</p>
</div>
<div class="paragraph">
<p>Even if PureBasic automatically free the allocated memory areas, it will occur only when the programs ends. During programs execution, it is up to the user to take care of any memory waste especially its growth.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="inheritance-4"><a class="anchor" href="#inheritance-4"></a>8.7. Inheritance</h3>
<div class="paragraph">
<p>In the set of commands just exposed, nothing makes reference to the inheritance process. It is normal because current commands do not support this! (Damn! Fear!)! We need to decline an additional set of commands to deal with the concept (Arghhh! &lt;death pangs&gt;).</p>
</div>
<div class="paragraph">
<p>Fortunately, it is not rocket science as our conception is ready for this (Phew! I feeling better now).</p>
</div>
<div class="paragraph">
<p>Here what looks like the class in that case:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic pseudocode" data-lang="purebasic pseudocode">; Object class
ClassEx(&lt;ClassName&gt;,&lt;MotherClass&gt;)
  [Method1()]
  [Method2()]
  [Method3()]
  ...
  MethodsEx(&lt;ClassName&gt;,&lt;MotherClass&gt;)
    [&lt;*Method1&gt;]
    [&lt;*Method2&gt;]
    [&lt;*Method3&gt;]
    ...
  MembersEx(&lt;ClassName&gt;,&lt;MotherClass&gt;)
    [&lt;Attribute1&gt;]
    [&lt;Attribute2&gt;]
    ...
EndClass(&lt;ClassName&gt;)

; Object methods (implementation)
Method(&lt;ClassName&gt;, Method1) [,&lt;variable1 [= DefaultValue]&gt;,...])
  ...
  [ProcedureReturn value]
EndMethod(&lt;ClassName&gt;, Method1)

...(ditto for each method)

; Object constructor
NewEx(&lt;ClassName&gt;,&lt;MotherClass&gt;)
  ...
EndNew

; Object destructor
Free(&lt;ClassName&gt;)
  ...
EndFree</code></pre>
</div>
</div>
<div class="paragraph">
<p>Four extra keywords are supplied: ClassEx, MethodsEx, MembersEx and NewEx as a replacement of Class, Methods, Members and New.</p>
</div>
<div class="paragraph">
<p>For each new keyword, in addition of the name of the current class, the name of the mother class is given as a new argument.</p>
</div>
<div class="paragraph">
<p>The operation is finally rather simple for the user with a very easy process for inheritance.</p>
</div>
<div class="paragraph">
<p>I won’t list the declaration of the new keywords here to save space, but it might be a good idea to check out OOP.pbi in your IDE to get a feel for it.</p>
</div>
</div>
<div class="sect2">
<h3 id="discussion"><a class="anchor" href="#discussion"></a>8.8. Discussion</h3>
<div class="paragraph">
<p>Phew! The presentation of a PureBasic Class is finished.</p>
</div>
<div class="paragraph">
<p>What else? Well, macros allow to define a real set of commands that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Clarified the object structure,</p>
</li>
<li>
<p>Facilitate or automate some processes, as the methods initialization or the inheritance.
I list here the various choices which drive the conception to the object. Let me you feel that it is possible to adapt some parts to suit one’s style to one’s object without fundamentally modifying it:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use of StructureUnion to define the object. It confers to the object the peculiarity to act on the members without using any accessor method.</p>
</li>
<li>
<p>The table of methods is class-specific and not object-specific.</p>
</li>
</ol>
</div>
</li>
<li>
<p>It is initialized once at the beginning of the program and not at the intanciate level of an object,</p>
</li>
<li>
<p>Objects instance store only a pointer towards the table of methods: substantial save of memory space,</p>
</li>
<li>
<p>All the objects point towards the same table of methods, which guarantees an identical behavior of the objects from the same class.3.  A constructor which initializes the object, driving to use a single pointer as input parameter which store the initialisation data of the object. The process of inheritance is largely facilitated.
We can envisage to split the process in two steps: step one, the user create an object, step two the user calls the routine of initialization himself. In this case, method Init_Mbers is not called by New method and then it can support number of arguments.Two disadvantages:</p>
</li>
<li>
<p>The risk of an incorrect initialization of the object: one can forget to do it, but -more important- it’s not possible any more to automate the process of inheritance: it’s up to the user to manage it!</p>
</li>
<li>
<p>A strong class-interdependence for enter parameters: as soon as the parameters of the initialization method change from the mother class, the user has to proceed this modification in all the child classes.
In extreme, but it’s not advisable, we can imagine that the user initializes member after member by using accessors. But a member initialization is not always a single assignation. It can require more complex internal operations to reach the assignation. Repeat this at each new object, it is advised to keep this into a dedicated method.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A destructor consistent with the constructor. It is not a part of the interface although it is possible. In this case, to free an object write ' Objet\Md\Free () ' instead of writing ' Free_ClassName ( object) '. This disposal is easy to operate and doesn’t modify the conception of the object.</p>
</li>
<li>
<p>I didn’t achieve the automation of the table of methods. It is important to remind why it is articulated with a structure. Structure allows to create abstract classes, that are classes where all the methods are not implemented. It is a major notion of the object concepts. Structure facilitates to preserve the addresses order into the table of methods what ever the implemented methods are while preserve the inheritance process! An array, a linkedlist or a hash map as a replacement of a structure shall not have this flexibility (at least I didn’t find a such solution).</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="reminder-of-types"><a class="anchor" href="#reminder-of-types"></a>8.9. Reminder of types</h3>
<div class="paragraph">
<p>Find here the list of the types which are used by a class:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Applied to</th>
<th class="tableblock halign-left valign-top">Origin</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mbrs_&lt;ClassName&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Members structure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EndClass</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;ClassName&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Object instance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EndClass</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;ClassName&gt;_</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mthds_&lt;ClassName&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Table of methods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Methods</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mbrs_&lt;ClassName&gt;_</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Members structure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Members</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Mbrs_&lt;ClassName&gt;_ type wasn’t presented in this paper. It is an intermediary step used to build the Mbrs_&lt;ClassName&gt; structure of the members definition. This arrangement is required to achieve the *this\Instance feature exposed here</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conclusion-2"><a class="anchor" href="#conclusion-2"></a>9. Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You will have understood that, if it is possible to adopt a Object-Oriented Programming in PureBasic, a rigor of writing is required.
But once this task released, the object manipulation is excessively simple.</p>
</div>
<div class="paragraph">
<p>Now if the Objects languages bring a bigger flexibility in writing codes (according to a direct object concepts using), its organization is articulated on using a lot of methods which leads to some performance loses.</p>
</div>
<div class="paragraph">
<p>Nevertheless, I hope that this tutorial will have allowed you, at first, to realize the underlying mechanisms in the OOP and to understand the concepts.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="optimisations"><a class="anchor" href="#optimisations"></a>Appendix A: Optimisations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The paragraphs which follow deal with considerations on our Object-oriented approach to improve the program runtime the performances of .</p>
</div>
<div class="sect2">
<h3 id="optimisation-get-and-set-methods"><a class="anchor" href="#optimisation-get-and-set-methods"></a>A.1. Optimisation: Get() and Set() methods</h3>
<div class="paragraph">
<p>By making frequent calls to Get() and Set() methods, it means many function calls and a loss of performance.
For those who are in search of performance, there are two possibilities to accelerate the process:</p>
</div>
<div class="paragraph">
<p>Both consist in coupling a pointer to the object, the second solution brings a layer to the first one.</p>
</div>
<div class="sect3">
<h4 id="first-solution"><a class="anchor" href="#first-solution"></a>A.1.1. First solution:</h4>
<div class="paragraph">
<p>The pointer is specified by the Class Structure.
So, for an object Rect from the Rectangle1 Class, write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Rect.Rect = New_Rect()
*Rect.Rectangle1 = Rect</code></pre>
</div>
</div>
<div class="paragraph">
<p>To act on var2 attribute write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">*Rect\var2</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is then possible both to examine and to modify it.
This is the more simple solution to implement.</p>
</div>
</div>
<div class="sect3">
<h4 id="second-solution"><a class="anchor" href="#second-solution"></a>A.1.2. Second solution:</h4>
<div class="paragraph">
<p>The first solution asks to work with two different typed elements: Rect and *Rect.
This second solution, suggests grouping these two elements in a StructureUnion block.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Structure Rect_
  StructureUnion
    Mthd.Rect
    *Mbers.Rectangle1
  EndStructureUnion
EndStructure</code></pre>
</div>
</div>
<div class="paragraph">
<p>Creating an object from Class Rectangle1, means declaring the object thanks to this new Structure.
By adapting the constructor, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">New_Rect(@Rect.Rect_)</code></pre>
</div>
</div>
<div class="paragraph">
<p>with,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Procedure New_Rect(*Instance.Rect_)
  *Rect = AllocateMemory(SizeOf(Rectangle2))
  Init_Rect1(*Rect)
  Init_Rect2(*Rect)
  *Instance\Mthd = *Rect
EndProcedure</code></pre>
</div>
</div>
<div class="paragraph">
<p>To access to the Draw() method, write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Rect\Mthd\Draw()</code></pre>
</div>
</div>
<div class="paragraph">
<p>To access to the var2 attribute, write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-purebasic" data-lang="purebasic">Rect\Mbers\var2</code></pre>
</div>
</div>
<div class="paragraph">
<p>This second solution has the advantage to have only a single element that can be deal as an object from which all the attributes are accessible from outside of the class.
It preserves also object-oriented notation, although it presents a supplementary level of fields.</p>
</div>
<div class="paragraph">
<p>The inconvenience concerns essentially the fact that it is necessary to maintain a new structure within the Class.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Draft 0.1<br>
Last updated 2016-11-09 19:38:44 E
</div>
</div>
<link rel="stylesheet" href="../hjs/styles/github.min.css">
<script src="../hjs/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>